<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title th:text="${pageTitle} + ' - LinkVault'">LinkVault</title>
    <link rel="stylesheet" th:href="@{/css/style.css}"/>
</head>
<body>
<div class="app-layout">
    <div th:replace="~{fragments/layout :: sidebar}"></div>

    <div class="main-content">
        <div class="header-bar">
            <h2 th:text="${pageTitle}">All Bookmarks</h2>
            <div style="display: flex; gap: 8px; align-items: center;">
                <form class="search-form" action="/search" method="get">
                    <input type="text" name="keyword" class="search-input" placeholder="Search bookmarks..."/>
                    <button type="submit" class="btn btn-primary">Search</button>
                </form>
                <button class="btn btn-primary" onclick="openAddModal()">+ Add</button>
            </div>
        </div>

        <!-- Frequently Accessed -->
        <div th:if="${frequent != null and !frequent.isEmpty()}" class="frequent-bar">
            <th:block th:each="b : ${frequent}">
                <a href="javascript:void(0)" class="frequent-chip js-access-link"
                   th:data-id="${b.id}" th:data-url="${b.url}">
                    <img th:if="${b.favicon != null and !b.favicon.isEmpty()}" th:src="${b.favicon}" alt="" onerror="this.style.display='none'"/>
                    <span th:text="${b.title}">Bookmark</span>
                </a>
            </th:block>
        </div>

        <!-- Bookmark List -->
        <div class="bookmark-grid" th:if="${bookmarks != null and bookmarks.totalElements > 0}">
            <th:block th:each="bookmark : ${bookmarks.content}">
                <div th:replace="~{fragments/layout :: bookmarkCard(${bookmark})}"></div>
            </th:block>
        </div>
        <div class="empty-state" th:if="${bookmarks == null or bookmarks.totalElements == 0}">
            <h3>No bookmarks yet</h3>
            <p>Click "+ Add" to save your first bookmark.</p>
        </div>

        <!-- Pagination -->
        <div th:if="${bookmarks != null}" th:replace="~{fragments/layout :: pagination(${bookmarks})}"></div>
    </div>
</div>

<div th:replace="~{fragments/layout :: bookmarkModal}"></div>
<div th:replace="~{fragments/layout :: folderModal}"></div>
<script th:src="@{/js/app.js}"></script>
</body>
</html>
