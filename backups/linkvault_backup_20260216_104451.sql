-- H2 2.1.214;
;             
CREATE USER IF NOT EXISTS "SA" SALT '30fc3bd46ca8568c' HASH '09c1c875f0a067e8640809997f7a36e6b7bf3af049e49288bc1fe12a71511042' ADMIN;         
CREATE MEMORY TABLE "PUBLIC"."AUDIT_LOGS"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "ACTION" CHARACTER VARYING(50) NOT NULL,
    "DETAILS" CHARACTER VARYING(500),
    "ENTITY_ID" BIGINT,
    "ENTITY_TYPE" CHARACTER VARYING(50),
    "TIMESTAMP" TIMESTAMP NOT NULL,
    "USER_ID" BIGINT
);   
ALTER TABLE "PUBLIC"."AUDIT_LOGS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_8" PRIMARY KEY("ID");   
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.AUDIT_LOGS;              
CREATE INDEX "PUBLIC"."IDX_AUDIT_USER" ON "PUBLIC"."AUDIT_LOGS"("USER_ID" NULLS FIRST);       
CREATE INDEX "PUBLIC"."IDX_AUDIT_TIMESTAMP" ON "PUBLIC"."AUDIT_LOGS"("TIMESTAMP" NULLS FIRST);
CREATE INDEX "PUBLIC"."IDX_AUDIT_ACTION" ON "PUBLIC"."AUDIT_LOGS"("ACTION" NULLS FIRST);      
CREATE MEMORY TABLE "PUBLIC"."BOOKMARK_TAGS"(
    "BOOKMARK_ID" BIGINT NOT NULL,
    "TAG_ID" BIGINT NOT NULL
);           
ALTER TABLE "PUBLIC"."BOOKMARK_TAGS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_D" PRIMARY KEY("BOOKMARK_ID", "TAG_ID");             
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.BOOKMARK_TAGS;           
CREATE MEMORY TABLE "PUBLIC"."BOOKMARKS"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "ACCESS_COUNT" INTEGER NOT NULL,
    "CREATED_AT" TIMESTAMP NOT NULL,
    "DESCRIPTION" CHARACTER VARYING(1000),
    "FAVICON" CHARACTER VARYING(2048),
    "LAST_ACCESSED_AT" TIMESTAMP,
    "TITLE" CHARACTER VARYING(255) NOT NULL,
    "UPDATED_AT" TIMESTAMP,
    "URL" CHARACTER VARYING(2048) NOT NULL,
    "FOLDER_ID" BIGINT,
    "USER_ID" BIGINT
);             
ALTER TABLE "PUBLIC"."BOOKMARKS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_1" PRIMARY KEY("ID");    
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.BOOKMARKS;               
CREATE INDEX "PUBLIC"."IDX_BOOKMARK_URL" ON "PUBLIC"."BOOKMARKS"("URL" NULLS FIRST);          
CREATE INDEX "PUBLIC"."IDX_BOOKMARK_TITLE" ON "PUBLIC"."BOOKMARKS"("TITLE" NULLS FIRST);      
CREATE INDEX "PUBLIC"."IDX_BOOKMARK_FOLDER" ON "PUBLIC"."BOOKMARKS"("FOLDER_ID" NULLS FIRST); 
CREATE INDEX "PUBLIC"."IDX_BOOKMARK_USER" ON "PUBLIC"."BOOKMARKS"("USER_ID" NULLS FIRST);     
CREATE INDEX "PUBLIC"."IDX_BOOKMARK_ACCESS_COUNT" ON "PUBLIC"."BOOKMARKS"("ACCESS_COUNT" NULLS FIRST);        
CREATE INDEX "PUBLIC"."IDX_BOOKMARK_CREATED_AT" ON "PUBLIC"."BOOKMARKS"("CREATED_AT" NULLS FIRST);            
CREATE MEMORY TABLE "PUBLIC"."FOLDERS"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "CREATED_AT" TIMESTAMP NOT NULL,
    "DISPLAY_ORDER" INTEGER NOT NULL,
    "NAME" CHARACTER VARYING(255) NOT NULL,
    "PARENT_ID" BIGINT,
    "USER_ID" BIGINT
);
ALTER TABLE "PUBLIC"."FOLDERS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_2" PRIMARY KEY("ID");      
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.FOLDERS; 
CREATE INDEX "PUBLIC"."IDX_FOLDER_PARENT" ON "PUBLIC"."FOLDERS"("PARENT_ID" NULLS FIRST);     
CREATE INDEX "PUBLIC"."IDX_FOLDER_USER" ON "PUBLIC"."FOLDERS"("USER_ID" NULLS FIRST);         
CREATE INDEX "PUBLIC"."IDX_FOLDER_DISPLAY_ORDER" ON "PUBLIC"."FOLDERS"("DISPLAY_ORDER" NULLS FIRST);          
CREATE MEMORY TABLE "PUBLIC"."TAGS"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "NAME" CHARACTER VARYING(255) NOT NULL
);
ALTER TABLE "PUBLIC"."TAGS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_27" PRIMARY KEY("ID");        
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.TAGS;    
CREATE MEMORY TABLE "PUBLIC"."USERS"(
    "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 3) NOT NULL,
    "CREATED_AT" TIMESTAMP NOT NULL,
    "EMAIL" CHARACTER VARYING(255) NOT NULL,
    "ENABLED" BOOLEAN NOT NULL,
    "LAST_LOGIN_AT" TIMESTAMP,
    "PASSWORD" CHARACTER VARYING(255) NOT NULL,
    "ROLE" CHARACTER VARYING(10) NOT NULL,
    "USERNAME" CHARACTER VARYING(50) NOT NULL
);           
ALTER TABLE "PUBLIC"."USERS" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_4" PRIMARY KEY("ID");        
-- 2 +/- SELECT COUNT(*) FROM PUBLIC.USERS;   
INSERT INTO "PUBLIC"."USERS" VALUES
(1, TIMESTAMP '2026-02-16 10:44:07.184923', 'admin@linkvault.com', TRUE, NULL, '$2a$10$9jcYz3u2/01BeykDHcTqHe9VqwzFO1y.89y2Vbaei3ZmszZ5S3brO', 'ADMIN', 'admin'),
(2, TIMESTAMP '2026-02-16 10:44:07.284087', 'user@linkvault.com', TRUE, NULL, '$2a$10$puTTrdXjZ6xgW6CsGnuJHehlh2MBV8vx63VSRPeqK3ARnnfpH8rhC', 'USER', 'user');        
CREATE INDEX "PUBLIC"."IDX_USER_USERNAME" ON "PUBLIC"."USERS"("USERNAME" NULLS FIRST);        
CREATE INDEX "PUBLIC"."IDX_USER_EMAIL" ON "PUBLIC"."USERS"("EMAIL" NULLS FIRST);              
ALTER TABLE "PUBLIC"."USERS" ADD CONSTRAINT "PUBLIC"."UK_R43AF9AP4EDM43MMTQ01ODDJ6" UNIQUE("USERNAME");       
ALTER TABLE "PUBLIC"."TAGS" ADD CONSTRAINT "PUBLIC"."UK_T48XDQ560GS3GAP9G7JG36KGC" UNIQUE("NAME");            
ALTER TABLE "PUBLIC"."USERS" ADD CONSTRAINT "PUBLIC"."UK_6DOTKOTT2KJSP8VW4D0M25FB7" UNIQUE("EMAIL");          
ALTER TABLE "PUBLIC"."AUDIT_LOGS" ADD CONSTRAINT "PUBLIC"."FKJS4IIMVE3Y0XSSBTVE5YSYEF0" FOREIGN KEY("USER_ID") REFERENCES "PUBLIC"."USERS"("ID") NOCHECK;     
ALTER TABLE "PUBLIC"."BOOKMARKS" ADD CONSTRAINT "PUBLIC"."FKGW1OD0YVY1N3R2P0R4CB7X57A" FOREIGN KEY("FOLDER_ID") REFERENCES "PUBLIC"."FOLDERS"("ID") NOCHECK;  
ALTER TABLE "PUBLIC"."BOOKMARKS" ADD CONSTRAINT "PUBLIC"."FKDBSHO2E05W5R13FKJQFJMGE5F" FOREIGN KEY("USER_ID") REFERENCES "PUBLIC"."USERS"("ID") NOCHECK;      
ALTER TABLE "PUBLIC"."FOLDERS" ADD CONSTRAINT "PUBLIC"."FKQCP836DGME9195J0WY9V3B6O3" FOREIGN KEY("PARENT_ID") REFERENCES "PUBLIC"."FOLDERS"("ID") NOCHECK;    
ALTER TABLE "PUBLIC"."FOLDERS" ADD CONSTRAINT "PUBLIC"."FKC2QOOQ7M62V6O0C8PTAJ3X4CJ" FOREIGN KEY("USER_ID") REFERENCES "PUBLIC"."USERS"("ID") NOCHECK;        
ALTER TABLE "PUBLIC"."BOOKMARK_TAGS" ADD CONSTRAINT "PUBLIC"."FK407DFUYYQ0TJ439WW5W1JFPH8" FOREIGN KEY("TAG_ID") REFERENCES "PUBLIC"."TAGS"("ID") NOCHECK;    
ALTER TABLE "PUBLIC"."BOOKMARK_TAGS" ADD CONSTRAINT "PUBLIC"."FKRDBRRV4S1A8YBX3JJ46I297VB" FOREIGN KEY("BOOKMARK_ID") REFERENCES "PUBLIC"."BOOKMARKS"("ID") NOCHECK;          
